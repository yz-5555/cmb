#include "cmb.h"
#include "cmb_utils.h"

// utils
int cmb_setup()
{
	return cd_here();
}
// commands
void cmb_help()
{
    printf("Usage: cmb <command> [options]\n"
           "`cmb` is a simple CLI tool for project management and build automation using CMake.\n\n"
           "Commands:\n"
           "  cmb new <project_name>\n"
           "      Create a new project in the current directory with the specified\n"
           "      <project_name>. This will automatically generate a few folders\n"
           "      and files. <project_name> is required.\n\n"

           "  cmb init [kit_name] [kits_path]\n"
           "      Generate CMake build files by reading the cmake-kits.json at\n"
           "      the specified <kits_path>. This step configures the generator,\n"
           "      compiler, and other settings based on the <kit_name>.\n"
           "      - If <kits_path> is omitted, the command will look for the file\n"
           "        in the current directory.\n"
           "      - If <kit_name> is omitted, the first entry in the JSON array\n"
           "        will be selected.\n\n"

           "  cmb build\n"
           "      Build the project using the build files generated by `cmb init`.\n"
           "      The output (e.g., executable files) will be placed in the\n"
           "      designated output directory.\n\n"

           "  cmb run\n"
           "      Run the output generated by `cmb build`.");
}
int cmb_new(int argc, char* argv[])
{
	// Create root dir
	if (make_root(argv[2]) == 1)
		return 1;
	// Create directories	
	if (make_directories() == 1)
		return 1;

	// Create src/main.c
    FILE* file = NULL;
    if (write_main(file) == 1)
		return 1;

    // Create CMakeLists.txt
    file = NULL;
    if (write_cmake_lists(file, argv[2]) == 1)
		return 1;

	// Create cmb_config.json
	file = NULL;
	if (write_cmb_config(file) == 1)
		return 1;

    return 0;
}
void cmb_init(int argc, char* argv[])
{
	printf("cmb_init");
}
void cmb_build(int argc, char* argv[])
{
    printf("cmb_build");
}
void cmb_clean(int argc, char* argv[])
{
    printf("cmb_clean");
}
void cmb_run(int argc, char* argv[])
{
    printf("cmb_run");
}
